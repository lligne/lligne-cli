//
// (C) Copyright 2023 Martin E. Nordberg III
// Apache 2.0 License
//

package bytecode

import (
	"fmt"
	"strings"
)

//=====================================================================================================================

type Disassembler struct {
	output strings.Builder
	line   int
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) BoolAnd() {
	d.write("BOOL_AND")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) BoolLoadFalse() {
	d.write("BOOL_LOAD_FALSE")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) BoolLoadTrue() {
	d.write("BOOL_LOAD_TRUE")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) BoolNot() {
	d.write("BOOL_NOT")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) BoolOr() {
	d.write("BOOL_OR")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) GetOutput() string {
	return d.output.String() + "\n"
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) Int64Add() {
	d.write("INT64_ADD")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) Int64Divide() {
	d.write("INT64_DIVIDE")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) Int64Equals() {
	d.write("INT64_EQUALS")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) Int64GreaterThan() {
	d.write("INT64_GREATER")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) Int64GreaterThanOrEquals() {
	d.write("INT64_NOT_LESS")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) Int64LessThan() {
	d.write("INT64_LESS")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) Int64LessThanOrEquals() {
	d.write("INT64_NOT_GREATER")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) Int64LoadInt16(operand int16) {
	d.writeInt16("INT64_LOAD_INT16", operand)
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) Int64LoadOne() {
	d.write("INT64_LOAD_ONE")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) Int64LoadZero() {
	d.write("INT64_LOAD_ZERO")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) Int64Negate() {
	d.write("INT64_NEGATE")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) Int64Multiply() {
	d.write("INT64_MULTIPLY")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) Int64Subtract() {
	d.write("INT64_SUBTRACT")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) NoOp() {
	d.write("NO_OP")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) Return() {
	d.write("RETURN")
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) write(opCode string) {
	d.output.WriteString("\n")
	d.line += 1
	d.output.WriteString(fmt.Sprintf("%4d  %s", d.line, opCode))
}

//---------------------------------------------------------------------------------------------------------------------

func (d *Disassembler) writeInt16(opCode string, operand int16) {
	d.output.WriteString("\n")
	d.line += 1
	d.output.WriteString(fmt.Sprintf("%4d  %-20s %6d", d.line, opCode, operand))
}

//=====================================================================================================================
